

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Developer Documentation &mdash; MPoL 0.1.1.dev0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/faculty.css" type="text/css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans|Roboto:400,700|Roboto+Mono:400,700&display=swap" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Gridding and diagnostic images" href="tutorials/gridder.html" />
    <link rel="prev" title="Units and Conventions" href="units-and-conventions.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

  
    <a class="heading heading-extra-margin" href="index.html">
      <div class="logo-box logo-box-large">
        <img class="logo" src="_static/logo.png"/>
      </div>
      
        <span class="icon icon-home"> MPoL</span>
      
    </a>
  

  
    
    
      <div class="version">0.1.1.dev0</div>
    
  

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="units-and-conventions.html">Units and Conventions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Developer Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#code-bugs-and-enhancements">Code Bugs and Enhancements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing">Testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#test-cache">Test cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="#viewing-test-and-debug-plots">Viewing test and debug plots</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#contributing">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#developing-tutorials">Developing tutorials</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tutorial-best-practices">Tutorial best practices</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/gridder.html">Gridding and diagnostic images</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/optimization.html">Optimization Loop</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/crossvalidation.html">Cross validation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MPoL</a>
        
      </nav>


      <div class="wy-nav-content">

  

  
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
  <li class="breadcrumb"><a href="index.html">MPoL</a> &raquo;</li>
    
  <li class="breadcrumb">Developer Documentation</li>

    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/developer-documentation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="developer-documentation">
<span id="developer-documentation-label"></span><h1>Developer Documentation<a class="headerlink" href="#developer-documentation" title="Permalink to this headline">¶</a></h1>
<p>If you are new to contributing code to a project, we recommend a quick read through the excellent contributing guides of the <a class="reference external" href="https://docs.exoplanet.codes/en/stable/user/dev/">exoplanet</a> and <a class="reference external" href="https://docs.astropy.org/en/stable/development/workflow/development_workflow.html">astropy</a> packages. What follows in this guide draws upon many of the suggestions from those two resources.</p>
<div class="section" id="code-bugs-and-enhancements">
<h2>Code Bugs and Enhancements<a class="headerlink" href="#code-bugs-and-enhancements" title="Permalink to this headline">¶</a></h2>
<p>If you find an issue with the code, documentation, or would like to make a suggestion for an improvement, please raise an issue on the <a class="reference external" href="https://github.com/MPoL-dev/MPoL/issues">Github repository</a>.</p>
<blockquote>
<div></div></blockquote>
</div>
<div class="section" id="testing">
<span id="testing-reference-label"></span><h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h2>
<p>MPoL includes a test suite written using <a class="reference external" href="https://docs.pytest.org/">pytest</a>. You can install the package dependencies for testing via</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install .[test]
</pre></div>
</div>
<p>after you’ve cloned the repository and changed to the root of the repository.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you use the zsh shell, you might need to try <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">'.[test]'</span></code> instead.</p>
</div>
<p>To run all of the tests, from  the root of the repository, invoke</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python -m pytest
</pre></div>
</div>
<p>If a test errors on a stable branch, please report what went wrong as an issue on the <a class="reference external" href="https://github.com/MPoL-dev/MPoL/issues">Github repository</a>.</p>
<div class="section" id="test-cache">
<h3>Test cache<a class="headerlink" href="#test-cache" title="Permalink to this headline">¶</a></h3>
<p>Several of the tests require mock data that is not practical to package within the github repository itself, and so it is stored on Zenodo and downloaded using astropy caching functions. If you run into trouble with the test cache becoming stale, you can delete it by deleting the <code class="docutils literal notranslate"><span class="pre">.mpol/cache</span></code> folder in home directory.</p>
</div>
<div class="section" id="viewing-test-and-debug-plots">
<h3>Viewing test and debug plots<a class="headerlink" href="#viewing-test-and-debug-plots" title="Permalink to this headline">¶</a></h3>
<p>Some tests produce temporary files, like plots, that could be useful to view for development or debugging. Normally these are saved to a temporary directory created by the system which will be cleaned up after the tests finish. To preserve them, first create a plot directory (e.g., <code class="docutils literal notranslate"><span class="pre">plotsdir</span></code>) and then run the tests with this <code class="docutils literal notranslate"><span class="pre">--basetemp</span></code> specified</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mkdir plotsdir
$ python -m pytest --basetemp=plotsdir
</pre></div>
</div>
</div>
</div>
<div class="section" id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h2>
<p>We use a “fork and pull request” model for collaborative development on Github, using git. If you are unfamiliar with this workflow, check out this short Github guide on <a class="reference external" href="https://guides.github.com/activities/forking/">forking projects</a>. For even more reference material, see the official Github documentation on <a class="reference external" href="https://docs.github.com/en/github/collaborating-with-issues-and-pull-requests">collaborating with issues and pull requests</a>.</p>
<p>After forking the MPoL repository to your own github account, clone the repository and install it with the development tools in editable mode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/MPoL-dev/MPoL.git
$ cd MPoL
$ pip install -e .[dev]
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you use the zsh shell, you might need to try <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">'.[dev]'</span></code> instead.</p>
</div>
<p>Before starting to make any changes, you should first run the tests as described <a class="reference internal" href="#testing-reference-label"><span class="std std-ref">Testing</span></a> to make sure everything passes.</p>
<p>Once you’re done making your changes, run the test suite again. If any tests fail, please address these issues before submitting a pull request. If you’ve changed a substantial amount of code or added new features, you should write new tests covering these changes. Instructions on how to write new tests can be found in the <a class="reference external" href="https://docs.pytest.org/en/stable/contents.html#toc">pytest documentation</a> and the <code class="docutils literal notranslate"><span class="pre">MPoL/tests/</span></code> directory contains many examples.</p>
<p>Once you are satisfied with your changes and all tests pass, initiate a pull request back to the main <a class="reference external" href="https://github.com/MPoL-dev/MPoL/">MPoL-dev/MPoL repository</a> as described in the Github guide on <a class="reference external" href="https://guides.github.com/activities/forking/">forking projects</a>. Thank you for your contribution!</p>
<div class="section" id="developing-tutorials">
<h3>Developing tutorials<a class="headerlink" href="#developing-tutorials" title="Permalink to this headline">¶</a></h3>
<p>Like with the <a class="reference external" href="https://docs.exoplanet.codes/en/stable/user/dev/">exoplanet</a> codebase, MPoL tutorials are written as <code class="docutils literal notranslate"><span class="pre">.py</span></code> python files and converted to Jupyter notebooks using <a class="reference external" href="https://jupytext.readthedocs.io/en/latest/">jupytext</a>. You can learn more about this neat plugin on the <a class="reference external" href="https://jupytext.readthedocs.io/en/latest/">jupytext</a> page. You don’t need to worry about pairing notebooks—we’re only interested in keeping the <code class="docutils literal notranslate"><span class="pre">.py</span></code> file up to date and committed to source control. For small tutorials, the <code class="docutils literal notranslate"><span class="pre">.py</span></code> file you create is the only thing you need to commit to the github repo (don’t commit the <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code> file to the git repository in this case). This practice keeps the git diffs small while making it easier to edit tutorials with an integrated development environment.</p>
<p>To write a tutorial:</p>
<ol class="arabic simple">
<li><p>copy and rename one of the existing <code class="docutils literal notranslate"><span class="pre">.py</span></code> files in <code class="docutils literal notranslate"><span class="pre">docs/tutorials/</span></code> to <code class="docutils literal notranslate"><span class="pre">docs/tutorials/your-new-tutorial</span></code>, being sure to keep the header metadata</p></li>
<li><p>start a Jupyter notebook kernel</p></li>
<li><p>open the <code class="docutils literal notranslate"><span class="pre">.py</span></code> file as a notebook and edit it like you would any other Jupyter notebook. If you’ve already installed the <a class="reference external" href="https://jupytext.readthedocs.io/en/latest/">jupytext</a> tool (as part of <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.[dev]</span></code>), your changes in the Jupyter notebook window should be automatically saved back to the <code class="docutils literal notranslate"><span class="pre">.py</span></code> file. As you progress, make sure you commit your changes in the <code class="docutils literal notranslate"><span class="pre">.py</span></code> file back to the repository (but don’t commit the <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code> file).</p></li>
</ol>
<p>When done, add a reference to your tutorial in the documentation table of contents. E.g., if your contribution is the <code class="docutils literal notranslate"><span class="pre">tutorials/gridder.py</span></code> file, add a <code class="docutils literal notranslate"><span class="pre">tutorials/gridder</span></code> line to the tabel of contents.</p>
<p>To build the docs locally, <code class="docutils literal notranslate"><span class="pre">cd</span></code> to the docs folder and run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html</span></code>. This script includes the line</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jupytext</span> <span class="o">--</span><span class="n">to</span> <span class="n">ipynb</span> <span class="o">--</span><span class="n">execute</span> <span class="n">tutorials</span><span class="o">/*.</span><span class="n">py</span>
</pre></div>
</div>
<p>which converts your <code class="docutils literal notranslate"><span class="pre">.py</span></code> file to a <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code> file and executes its contents, storing the cell output to the notebook. Then, when Sphinx builds the documention, the <a class="reference external" href="https://nbsphinx.readthedocs.io/">nbsphinx</a> plugin sees a Jupyter notebook and incorporates it into the build. If you’ve added any extra documentation build dependencies, please add them to the <code class="docutils literal notranslate"><span class="pre">EXTRA_REQUIRES['docs']</span></code> list in <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>.</p>
</div>
<div class="section" id="tutorial-best-practices">
<h3>Tutorial best practices<a class="headerlink" href="#tutorial-best-practices" title="Permalink to this headline">¶</a></h3>
<p>Tutorials should still be self-contained. If the tutorial requires a dataset, the dataset should be publically available and downloaded at the beginning of the script. If the dataset requires significant preprocessing (e.g., some multi-configuration ALMA datasets), those preprocessing steps should be in the tutorial. If the steps are tedious, one solution is to upload a preprocessed dataset to Zenodo and have the tutorial download the data product from there (the preprocessing scripts/steps should still be documented in the Zenodo repo). The guiding principle is that other developers should be able to successfully build the tutorial from start to finish without relying on any locally provided resources or datasets.</p>
<p>If you’re thinking about contributing a tutorial and would like guidance on form or scope, please raise an <a class="reference external" href="https://github.com/MPoL-dev/MPoL/issues">issue</a> or <a class="reference external" href="https://github.com/MPoL-dev/MPoL/discussions">discussion</a> on the github repository.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorials/gridder.html" class="btn btn-neutral float-right" title="Gridding and diagnostic images" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="units-and-conventions.html" class="btn btn-neutral float-left" title="Units and Conventions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019-21, Ian Czekala

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>


      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-5472810-8', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>